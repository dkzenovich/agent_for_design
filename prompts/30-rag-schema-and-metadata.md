---
mode: 'agent'
description: 'Спроектировать каноническую схему документа и метаданные для RAG-корпуса'
---

# 30-rag-schema-and-metadata

<context>
Описать единый формат документа RAG-корпуса, обязательные/опциональные поля и правила маппинга из источников.
</context>

<inputs>
- `target/rag_dataset_spec/03_sources_and_scope.md`
- Примеры структур документов/таблиц (если есть во входах)
</inputs>

<outputs>
- `target/rag_dataset_spec/04_schema_and_metadata.md` — каноническая схема документа, поля/метаданные, правила заполнения/обогащения.
- PDR: `pdrs/YYYY-MM-DDTHH-MM-SS_30-rag-schema-and-metadata.md`
</outputs>

<steps>
1) Задать каноническую структуру документа: заголовок, текст/контент, ссылки/аттачи, ключевые поля (product_code, region, версия и т.п.).
2) Для каждого поля указать: тип (строка/число/enum/дата), обязательность, источник заполнения (прямой маппинг vs вывод/обогащение), формат (например, ISO 8601, единицы измерения, язык).
3) Зафиксировать правила нормализации и допускаемые преобразования (классификация, NER, dedup, разбиение на чанки — только как требования к результату, без описания конкретных моделей).
4) Указать требования к метаданным для поиска/фильтрации и обеспечения безопасности (например, data_classification, owner, validity_period).
5) Отметить отброшенные поля, если они признаны избыточными или рискованными.
</steps>

<constraints>
- Не описывать техническую реализацию пайплайна; только структура и правила заполнения.
- Все форматы/единицы должны быть конкретными (UTC, ISO 8601, кодировки и т.д.).
- Помечать допущения по полям, если нет данных о структуре источника.
</constraints>

<audit_log>
- В PDR указать, почему выбраны обязательные поля, какие поля исключены, какие преобразования допустимы, какие артефакты обновлены.
</audit_log>
